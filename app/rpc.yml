imports:
  standard:
    path: ../pkg/rpc/standard/standard.yml
    import: miren.dev/runtime/pkg/rpc/standard

types:
  - type: AutoConcurrency
    fields:
      - name: factor
        type: int32
        index: 1

  - type: Configuration
    fields:
      - name: env_vars
        type: list
        element: NamedValue
        index: 0
      - name: concurrency
        type: int32
        index: 1
      - name: auto_concurrency
        type: AutoConcurrency
        index: 2

  - type: NamedValue
    fields:
      - name: key
        type: string
        index: 0
      - name: value
        type: string
        index: 1
      - name: sensitive
        type: bool
        index: 2

  - type: VersionInfo
    fields:
      - name: version
        type: string
      - name: created_at
        type: standard.Timestamp

  - type: AppInfo
    fields:
      - name: name
        type: string
      - name: created_at
        type: standard.Timestamp
      - name: current_version
        type: VersionInfo

interfaces:
  - name: Crud
    methods:
      - name: new
        parameters:
          - name: name
            type: string
        results:
          - name: id
            type: string
      - name: setConfiguration
        parameters:
          - name: app
            type: string
          - name: configuration
            type: Configuration
        results:
          - name: versionId
            type: string
      - name: getConfiguration
        parameters:
          - name: app
            type: string
        results:
          - name: configuration
            type: Configuration
          - name: versionId
            type: string
      - name: setHost
        parameters:
          - name: app
            type: string
          - name: host
            type: string
      - name: list
        results:
          - name: apps
            type: list
            element: AppInfo
      - name: destroy
        parameters:
          - name: name
            type: string
